#region Prolog

#****Begin: Generated Statements***
#****End: Generated Statements****

####################################
# -- Création d'une dimension
# -- ETA - Date: 27/03/2024
####################################

# -- Déclaration de variables
vDim= 'Product_Test';
zFile= vDim | '.txt';


# -- Définition du nom et de l'emplacement du fichier source

File = 'D:\Applications\Tm1\CarSales_Test\Fichier\'|zFile;

# -- Définition de la source de donnée
DataSourceNameForServer=File;

# Créer la dimension

IF( DimensionExists (vDim) = 0);

     DIMENSIONCREATE(vDim);
     
     # -- Créer l'element 'Total'
     DIMENSIONELEMENTINSERT(vDim, '' , ' Total' , 'C' );

     # -- On range les elements 
     DIMENSIONSORTORDER(vDim, 'ByInput','ASCENDING','ByHierarchy','ASCENDING');
ENDIF;


# -- Suppression des attributs et creation de attributs

AttrDelete( vDim , 'Color');
AttrDelete ( vDim , 'Customer Target');
AttrDelete ( vDim , 'Engine Type');
AttrDelete ( vDim , 'Engine Size');
AttrDelete ( vDim , 'Product Type');
AttrDelete ( vDim , 'Interior Type');

AttrInsert ( vDim ,'' , 'Color','S');
AttrInsert ( vDim , '', 'Customer Target','S');
AttrInsert ( vDim ,'' , 'Engine Type','S');
AttrInsert ( vDim ,'' , 'Engine Size','S');
AttrInsert ( vDim ,'' , 'Product Type','S');
AttrInsert ( vDim , '' , 'Interior Type','S');
#endregion
#region Metadata

#****Begin: Generated Statements***
#****End: Generated Statements****

# -- On insert tous les élements de la dimension

DIMENSIONELEMENTINSERT (vDim, '', Enfant, Type);

# -- Rattachement de l'enfant au parent
IF ( Parent @='');
	Itemskip;
ELSE;
	DIMENSIONELEMENTCOMPONENTADD(vDim, Parent, Enfant, Poids);
ENDIF;
#endregion
#region Data

#****Begin: Generated Statements***
#****End: Generated Statements****

# -- Création des attributs

AttrPuts (Color, vDim, Enfant, 'Color');
AttrPuts ( Customer, vDim, Enfant, 'Customer Target');
AttrPuts (EngineType, vDim, Enfant, 'Engine Type');
AttrPuts (EngineSize, vDim, Enfant, 'Engine Size');
AttrPuts (ProductType, vDim, Enfant, 'Product Type');
AttrPuts (Interior, vDim, Enfant, 'Interior Type');
#endregion
#region Epilog

#****Begin: Generated Statements***
#****End: Generated Statements****
#endregion